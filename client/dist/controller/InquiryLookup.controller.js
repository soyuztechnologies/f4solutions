sap.ui.define(["oft/fiori/controller/BaseController","sap/m/MessageBox","sap/m/MessageToast","oft/fiori/models/formatter","sap/ui/model/Filter","sap/viz/ui5/format/ChartFormatter","sap/viz/ui5/api/env/Format"],function(e,t,o,r,a,i,n){"use strict";return e.extend("oft.fiori.controller.InquiryLookup",{formatter:r,onInit:function(){this.oRouter=sap.ui.core.UIComponent.getRouterFor(this);this.oRouter.attachRoutePatternMatched(this.herculis,this);var e=JSON.parse(JSON.stringify(this.getOwnerComponent().getModel("local").getProperty("/courses")));e.splice(0,0,{courseName:"All Courses"});this.getOwnerComponent().getModel("local").setProperty("/inquiryLookupCourses",e);var t=this;var o=new Date;var r=this.byId("DRS3");r.setDateValue(new Date(o.getFullYear(),o.getMonth(),1));r.setSecondDateValue(new Date);var a=this.byId("DRS32");a.setDateValue(new Date(o.getFullYear(),o.getMonth(),1));a.setSecondDateValue(new Date);var i=this.byId("DRS33");i.setDateValue(new Date(o.getFullYear(),o.getMonth(),1));i.setSecondDateValue(new Date)},onBack:function(){sap.ui.getCore().byId("idApp").to("idView1")},herculis:function(e){var t=this;setTimeout(function(){t.onFilter();t.onFilter2();t.onFilter3()},2e3)},onChartTypeChange:function(e){this.getView().getModel("local").setProperty("/inquiryLookupVizType",e.getParameter("selectedItem").getKey())},onFilter:function(){var e=this;var o=this.byId("DRS3");var r=this.byId("idCourseName");var a=this.byId("idStaffName");var i={startDate:o.getFrom(),endDate:o.getTo(),staffId:a.getSelectedKey().split(" ")[0],course:r.getSelectedKey()==="All Courses"?null:r.getSelectedKey()};$.post("/inquiryLookup",i).done(function(t,o){debugger;e.getView().getModel("local").setProperty("/IquiryLookup",t)}).fail(function(e,o,r){t.error("Error in access")})},onFilter2:function(){var e=this;var o=this.byId("DRS32");var r={startDate:o.getFrom(),endDate:o.getTo()};$.post("/inquiryLookupMarketingReport",r).done(function(t,o){debugger;e.getView().getModel("local").setProperty("/IquiryLookupMarketingReport",t)}).fail(function(e,o,r){t.error("Error in access")})},onFilter3:function(){var e=this;var o=this.byId("DRS33");var r={startDate:o.getFrom(),endDate:o.getTo()};$.post("/inquiryLookupStaffReport",r).done(function(t,o){debugger;e.getView().getModel("local").setProperty("/IquiryLookupStaffReport",t)}).fail(function(e,o,r){t.error("Error in access")})},onSendMail:function(){var e=this.getView().getModel("local").getProperty("/IquiryLookup");var t=this.byId("idStaffName")._getSelectedItemText();var o=this.byId("idStaffName").getSelectedKey().split(" ")[1];var r=this.byId("DRS3");var a="Date\t\t|\t\tCount\n";e.forEach(function(e){a+="\n"+e.date+"\t|\t"+e.count});var i={subject:"Your Inquiries between "+r.getFrom().toDateString()+" - "+r.getTo().toDateString(),body:"Hello "+t+",\n\nPlease find details of your inquiries between "+r.getFrom().toDateString()+" - "+r.getTo().toDateString()+".\n\n"+a+"\n\n"+"Kindly check the dates where count was zero and maintain the work accordingly.\n\nRegards,\nAnubhav"};console.log(i)}})});